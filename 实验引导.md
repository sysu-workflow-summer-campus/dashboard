# 工作流实验室保研夏令营引导

## 工具介绍

本次的实验在所依赖的环境及工具包括：

- Ubuntu 16.04

    实验室已为每个用户提供一个远程环境，包含一个64位的Ubuntu 16.04环境，用户的所有程序都需要在该环境中运行

- Kubernetes

    实验室所给出的远程环境是可以连接到提供的kubernetes集群的，详细介绍后面给出

- Python/Golang

    请从上述中选择一个你熟悉的编程语言，完成本地计算机的环境及工具配置，对于Golang语言的使用者，建议本地进行编译后传输到实验室给出的远程环境上使用；对于python语言使用者，建议使用virtualenv工具进行环境的配置，并打包传输至远程环境上使用

- Kubernetes sdk

    要求使用kubernetes提供的sdk或使用kubectl完成编程实验，如何获取集群的权限及操作样例在后面会给出

### 任务提交说明

您所需要完成的每一个任务都会给出它的id号，请在完成实验后，在github上创建属于你自己的账户并上传代码，完成后请在该项目的issue下，发布一个`任务提交`类型的issue，并根据指引，完成您任务的提交

## 实验指南

### 起步

如果您还未曾了解过docker相关的知识，我们希望您可以去查看一下[阮一峰](http://www.ruanyifeng.com/blog/2018/02/docker-tutorial.html)关于docker的起步指南。最好的学习来源于实践，我们希望您可以在本地搭建属于自己的docker平台，并在[docker hub](https://hub.docker.com/)上传第一个属于你们自己的docker镜像

如果您对kubernetes的相关概念还一无所知，我们推荐你去它的官方网站跟着[在线教程](https://kubernetes.io/docs/home/)走一遍，并在文档中了解相关的概念，在阅读的过程中，我们希望您可以多关注这几个关键词：`pods`、`service`、`deployment`，对这几个概念有所了解将会帮助您更好地去完成接下来的实验

您无需在我们提供的远程环境上部署您自己的kubernetes环境，您所使用的远程环境本身就运行在一个kubernetes集群中，我们对它进行了适当的权限限制，使得您可以在完成实验的同时又不会破坏本地的环境；除此之外，您对kubernetes集群访问的token也被挂载到了您的远程环境中，您可以通过编程等方式来对kubernetes的接口进行调用，并执行相应的操作

### 利用kubernetes官方sdk对pod进行操作

这一部分是为了确保您已经掌握了kubernetes官方提供的sdk的基本操作，在这一部分中，我们将会给出一个样例，告诉你们如何去调用接口以完成操作，后续会提出扩展要求，请根据题目要求完成任务并提交

- [python sample](https://github.com/sysu-workflow-summer-campus/python-demo)

使用python语言调用kubernetes接口并完成获取指定namespace下所有pods及相关信息的操作

- [golang sample](https://github.com/sysu-workflow-summer-campus/golang-demo)

使用python语言调用kubernetes接口并完成创建一个pods的操作

#### 任务 #1

请根据给出的样例，部署[nginx镜像](https://hub.docker.com/_/nginx)至一个`pod`，不要求端口对外部映射

#### 任务 #2

利用代码对自己pod所属的命名空间下的productpage这一`deployment`应用进行实例扩缩

#### 任务 #3

实现一个针对productpage这一`deployment`进行实例扩缩的静态阈值法的demo

- 任务 #3.1

    请使用编程的方法获取访问应用得到的平均响应时间(提示：尽可能获取较为合理的平均响应时间)

- 任务 #3.2:

    自行设置响应时间的上界与下界，并根据你设置的值对productpage这一`deployment`进行扩缩容(提示：达到上界时扩容，达到下界时缩容，此外要根据实际情况来合理制定扩缩容的周期是多少)

- 任务 #3.3(附加任务)

    除了平均响应时间以外，还可以采取访问错误率的指标来同时作为阈值法的实例扩缩的依据

在完成以上任务后，除提交代码外，你还需要在代码项目的根目录中包含一个markdown文档(具体语法看[这里](https://www.jianshu.com/p/191d1e21f7ed))，该文档中是你对于`任务 #3`的实验报告。在报告中，除包含实验结果及运行结果外，还需要包含你在进行这个实验时的思路和心得体会，**请大胆地在实验报告中提出你在代码中尚未实现的内容**，但要求你的想法需要有一定的依据，而不是凭空猜测，这将会成为你区分于他人的闪光点。

## 注意事项

- 远程环境的初始用户名及密码都是`root`，请在登录后及时修改密码

- 远程环境是临时环境，对cpu及内存均有限制，超出限制的环境将被自动调度删除，删除后会进行重建，但重建后的环境将是一个空的环境，之前的所有配置都将被清空

- 远程环境的`/data`目录在环境被删除重建后仍然保留

- 远程环境及productpage这一`deployment`将会根据参与实验的人数进行分配，请记住自己分得的ip及端口，不扰乱他人工作可以体现你良好的个人素养

**最后，祝大家在夏令营中取得好的成绩！**
